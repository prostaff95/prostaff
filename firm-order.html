<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PROSTAFF — Firma chaqirish</title>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b1733; --card:#121f3f; --muted:#8fa3c9; --text:#e9f0ff;
      --brand1:#1773ff; --brand2:#00c2ff; --shadow:0 10px 30px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial}
    a{color:inherit;text-decoration:none}
    .nav{display:flex;gap:16px;align-items:center;justify-content:center;padding:18px 12px;background:linear-gradient(90deg,#0b1733,#0f2150)}
    .wrap{max-width:760px;margin:24px auto;padding:0 14px}
    .card{background:var(--card);border-radius:18px;padding:18px;box-shadow:var(--shadow)}
    .h1{font-size:24px;font-weight:800;margin:0 0 14px}
    label{display:block;margin:12px 0 6px;color:#c7d7ff}
    input,textarea,select{width:100%;padding:12px;border:1px solid #2a3b6b;border-radius:12px;background:#0e1a39;color:#fff}
    textarea{min-height:110px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .btn{margin-top:16px;padding:14px 18px;border-radius:12px;border:0;background:linear-gradient(90deg,var(--brand1),var(--brand2));color:#fff;font-weight:800;width:100%}
    .ghost{background:#0e1a39;border:1px solid #2a3b6b}
    .hint{color:var(--muted);font-size:13px;margin-top:6px}
    .pill{display:inline-block;background:#1b2b56;color:#cfe0ff;padding:6px 10px;border-radius:999px;font-size:12px;margin-right:6px}
    @media (max-width:640px){ .row{grid-template-columns:1fr} }
  </style>
</head>
<body>
  <nav class="nav">
    <a href="index.html">← Bosh sahifa</a>
    <a href="services.html">Firmalar</a>
  </nav>

  <div class="wrap">
    <div class="card">
      <div class="h1">Firma chaqirish</div>
      <div id="info"></div>

      <div class="row">
        <div>
          <label>Ismingiz</label>
          <input id="clientName" placeholder="Masalan, Akmal" />
        </div>
        <div>
          <label>Telefon raqam</label>
          <input id="clientPhone" placeholder="+998 ** *** ** **" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>Sana</label>
          <input id="date" type="date" />
        </div>
        <div>
          <label>Soat</label>
          <input id="time" type="time" />
        </div>
      </div>

      <label>Manzil (ixtiyoriy — ko‘cha/uy/kv.)</label>
      <input id="address" placeholder="Toshkent, Chilonzor 22, 12-uy, 45-xonadon" />

      <div class="row">
        <div>
          <label>Lokatsiya (GPS)</label>
          <input id="loc" placeholder="Lokatsiya havolasi yoki koordinata" />
          <div class="hint">“Lokatsiyani ulash” tugmasini bosing — koordinata avtomatik kiritiladi.</div>
        </div>
        <div style="display:flex;align-items:end;">
          <button id="btnGeo" class="btn ghost" type="button">Lokatsiyani ulash</button>
        </div>
      </div>

      <label>Izoh</label>
      <textarea id="note" placeholder="Ish haqida qisqacha: xona soni, maydon, maxsus talablar va h.k."></textarea>

      <button id="send" class="btn">Buyurtmani yuborish</button>
      <div class="hint">Tugmani bosgach, buyurtma ma’lumotlari yuboriladi (demo: xabar ko‘rinishida).</div>
    </div>
  </div>

  <script>
    // URL dan kelgan parametrlar (services.html → Chaqirish)
    const qs = new URLSearchParams(location.search);
    const company = qs.get('company') || 'Firma';
    const service = qs.get('service') || 'Xizmat';
    const city    = qs.get('city')    || '';
    const phone   = qs.get('phone')   || '';

    // Yuqorida firma haqida chiplar
    document.getElementById('info').innerHTML = `
      <span class="pill">${company}</span>
      <span class="pill">${service}</span>
      ${city ? `<span class="pill">${city}</span>` : ''}
      ${phone ? `<span class="pill">${phone}</span>` : ''}
    `;

    // Geolokatsiya → Google Maps link
    document.getElementById('btnGeo').addEventListener('click', ()=>{
      if(!navigator.geolocation){ alert("Qurilmada geolokatsiya yo'q."); return; }
      navigator.geolocation.getCurrentPosition(pos=>{
        const {latitude, longitude} = pos.coords;
        const link = `https://maps.google.com/?q=${latitude},${longitude}`;
        document.getElementById('loc').value = link;
      }, err=>{
        alert("Lokatsiya olinmadi: " + err.message);
      }, {enableHighAccuracy:true, timeout:10000});
    });

    // Yuborish (demo): xabarni yig‘ib ko‘rsatamiz yoki WhatsAppga yo‘naltirish mumkin
    document.getElementById('send').addEventListener('click', ()=>{
      const payload = {
        company, service, city, phone,
        clientName:  document.getElementById('clientName').value.trim(),
        clientPhone: document.getElementById('clientPhone').value.trim(),
        date:        document.getElementById('date').value,
        time:        document.getElementById('time').value,
        address:     document.getElementById('address').value.trim(),
        location:    document.getElementById('loc').value.trim(),
        note:        document.getElementById('note').value.trim()
      };

      // Xabar matni
      const text = 
`PROSTAFF orqali chaqiriq:
Firma: ${payload.company}
Xizmat: ${payload.service}
Shahar: ${payload.city}

Mijoz: ${payload.clientName} (${payload.clientPhone})
Sana/soat: ${payload.date || '—'} ${payload.time || ''}
Manzil: ${payload.address || '—'}
Lokatsiya: ${payload.location || '—'}

Izoh: ${payload.note || '—'}`;

      // Demo rejim: alert. Xohlasangiz WhatsAppga yo‘naltiring:
      // const wa = 'https://wa.me/' + (phone.replace(/\D/g,'')) + '?text=' + encodeURIComponent(text);
      // location.href = wa;

      alert(text);
    });

    // Default: bugungi sana/soat
    (function setDefaults(){
      const now = new Date();
      const d = now.toISOString().slice(0,10);
      const m = String(now.getMinutes()).padStart(2,'0');
      const h = String(now.getHours()).padStart(2,'0');
      document.getElementById('date').value = d;
      document.getElementById('time').value = `${h}:${m}`;
    })();
  </script>
</body>
</html>
